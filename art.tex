\documentclass{article}

\newlength\baselength
\setlength{\baselength}{1cm}
\newlength\globalwidth
\globalwidth=\dimexpr\baselength*40\relax
\newlength\globalheight
\globalheight=\dimexpr\baselength*20\relax
\newlength\margin
\margin\dimexpr\baselength/2\relax

 % https://tex.stackexchange.com/a/80510/71579
\usepackage[paperheight=\globalheight,paperwidth=\globalwidth,top=\margin,bottom=\margin,right=\margin,left=\margin]{geometry}
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{calc}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{shapes}

% Command to make the last slide, which shows copies of the other slides
\newlength\picwidth
\newlength\picheight
\newlength\picmargin
\newlength\nodewidth
\newlength\nodeheight
\newlength\gridwidth
\newlength\gridheight

\gridwidth=\dimexpr(\globalwidth-\margin-\margin-\margin-\margin)/23\relax
\gridheight=\dimexpr\gridwidth*297/210\relax  % These are A4 sheets

\picmargin=\dimexpr\baselength/10\relax
\nodewidth=\dimexpr\gridwidth-\picmargin\relax
\nodeheight=\dimexpr\gridheight-\picmargin\relax
\picwidth=\dimexpr\nodewidth\relax
\picheight=\dimexpr\nodeheight\relax

\begin{document}

% See:
%   https://academia.stackexchange.com/a/88068/37904
%   https://unix.stackexchange.com/a/277987/106103
%   https://stackoverflow.com/a/5349842/4110059
\thispagestyle{empty}
%\the\picwidth~\the\picheight~\the\picmargin~\the\gridheight

\newcommand{\addframe}[1] {\includegraphics[page=#1, width=\picwidth]{thesis_final.pdf}}

% TODO
% Compilation with pdflatex and lualatex fails.

\definecolor{mygray}{RGB}{240,240,240}
\pagecolor{mygray}
\centering
\topskip0pt
\vspace*{\fill}
\begin{tikzpicture}[x=\gridwidth,y=\gridheight]
    \foreach \y in {0,...,7}{
        \foreach \x in {1,...,23}{
            \pgfmathtruncatemacro{\n}{\y*23+\x}
            \node[draw=mygray, line width=0mm, fill=white, minimum width=\nodewidth, minimum height=\nodeheight, inner
                sep=0,outer sep=0] (i) at (\x, -\y) {\addframe{\n}} ; } }
\end{tikzpicture}
\vspace*{\fill}

\end{document}
